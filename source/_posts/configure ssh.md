---
title: How to Configure SSH with Multiple Github Accounts

date: 2023-09-23 15:20:17
categories:

  - development tool
tags :
  - development tool
  - program
  - github

description: 

 While I can use either HTTPS or SSH to clone the code, the most recommended way is to use SSH.This leads to a problem: Here's how to solve this problem.

cover: https://s2.loli.net/2023/09/23/e3LHsqUna2ZDYMW.png

---


## Introduction.

Here's what happened: I had already configured my `github` account with `ssh` key, but for uncontrollable reasons, I needed to use someone else's github account for a while, and I could have cloned the code with `https` and `ssh`, but I was advised to pull the code with `ssh`, and I ran into the problem of having to configure `multiple github accounts` with `ssh` on my own computer. I encountered the problem of having to configure `ssh` for `multiple github accounts` on my own computer.

## The process

When implementing the need to configure `SSH` for `multiple github accounts`, I first went to review how to add an `SSH key` on `github`, and then solved the problem of adding an `SSH key` on `multiple github accounts`, and then thought about how to implement the process of matching the domain name of the `GitHub` account with the key

## Add an SSH key to github.

### Create an SSH key

```bash

ssh-keygen -t rsa -C "your_email@example.com"

```

Path to the `ssh` key generated by default`~/.ssh/id_rsa`

### Continue creating SSH key

```bash

ssh-keygen -t rsa -C "your_email@example.com" -f ~/.ssh/id_rsa_other


```

`-f`command is optional, if you don't write it, you will also be asked to enter the filename after executing the code.

### check SSH key

```bash

cd ~/.ssh

ls

```

### Add the SSH key on github

- First

 `cat ~/.ssh/id_rsa.pub` to print out the public key information and copy it
- Then

login to your github account and go to the settings page

- Finally

click on `SSH and GPG keys` in the menu bar to go to the page to add an `SSH key` with an arbitrary title, and the content of the `Key` will be the public key to be copied.

## SSH config Configuration

Open the ``SSH configuration file (~/.ssh/config)`` and add the configuration for each ``GitHub`` account

```bash

Host domain alias
    HostName Domain name
    User git
    IdentityFile ~/.ssh/github_account1
    
```
## GitHub Domain Name

The domain name of a GitHub repository is usually `github.com`, but in some cases, especially for `Organizations` or `GitHub Pages` sites, the domain name can be customized.

### Multiple github accounts config Configuration

- The domain name is different

```javascript

Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_rsa
    
Host xxx.com
    HostName xxx.com
    User git
    IdentityFile ~/.ssh/id_rsa_xxx
    
```

- The domain names are the same, both are `github.com`
```javascript

Host github.com-account1
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_rsa_account1
    
Host github.com-account2
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_rsa_account2
    
```

The alias and domain name will be different for the same domain. When cloning or accessing a `GitHub` repository, you should use the configured alias as the hostname, not the default `github.com`

```bash

# github.com-account1、github.com-account2 replace github.com
git clone git@github.com-account1:username/repo1.git
git clone git@github.com-account2:username/repo2.git

```

### Test SSH key

```bash

ssh -T git@域名

```

## Expanding

### Difference between HTTPS and SSH cloning

`GitHub` supports two main protocols for cloning and interacting with remote repositories: `HTTPS` and `SSH`. You can choose whether to use `HTTPS` or `SSH` to interact with `GitHub` repositories based on your preferences and needs. In most cases, `HTTPS` will suffice.
Advantages of using `SSH`:

![11.png](https://s2.loli.net/2023/09/23/e3LHsqUna2ZDYMW.png)

More secure, since key pairs are used for authentication
Easier to authenticate, once the `SSH key pair` is configured, you don't need to enter the password every time.

### Permission denied (publickey)

To verify that the keys have all been added to the `SSH agent`, use the following command to list the keys in the agent:

```bash

ssh-add -l

```

If the key is not in the list, use the ssh-add command to add it to the agent:

```bash

ssh-add ~/.ssh/id_rsa
ssh-add ~/.ssh/is_rsa_xxx

```

### Host key verification failed

When using `ssh -T git@address` to test SSH connection, it keeps prompting: `Host key verification failed`, I read the error message because the `host` of the connection is not in the `known hosts list (~/.ssh/known_hosts)`, so I need to add the `known_hosts` file to the `known_hosts` file manually. hosts` file.

```bash

ssh-keyscan host >> ~/.ssh/known_hosts

```

Run the above command and then run `ssh -T git@address` to test the connection and you won't get any errors.

## Conclusion

Although I haven't encountered multiple github accounts configuring SSH before, I'd like to keep a record of it since I've encountered it. This time, the problem is different github accounts configuring SSH on different domains, but what if I encounter the problem next time when I have to configure SSH on the same domains with different github accounts? I'll just summarize and record it once and for all.
